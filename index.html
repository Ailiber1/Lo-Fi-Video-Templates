<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lo-Fi Video Templates - Free Lo-Fi Video Backgrounds</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,400;1,500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ======================================================
       ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆCSSå¤‰æ•°ï¼‰
       ====================================================== */
    :root {
      /* èƒŒæ™¯è‰² - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
      --bg-main: #F8F5F0;
      --bg-gradient-start: #FFFCF8;
      --bg-gradient-mid: #F5EDE3;
      --bg-gradient-end: #E8DFD3;
      --bg-card: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.75));
      --bg-card-solid: rgba(255, 255, 255, 0.85);
      --bg-card-hover: linear-gradient(145deg, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.9));
      --bg-header: transparent;
      --glow-color: rgba(212, 165, 116, 0.2);
      --shine-color: rgba(255, 255, 255, 0.9);
      --highlight-top: rgba(255, 255, 255, 0.8);
      --shadow-soft: rgba(180, 160, 140, 0.15);
      --shadow-medium: rgba(140, 120, 100, 0.12);

      /* ãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --text-primary: #2D2D2D;
      --text-secondary: #6B6B6B;
      --text-light: #FFFFFF;

      /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² - ã‚³ãƒƒãƒ‘ãƒ¼/ãƒ–ãƒ­ãƒ³ã‚ºç³» */
      --accent-copper: #C4846C;
      --accent-copper-hover: #B07560;
      --accent-warm: #D4A574;

      /* æ¤œç´¢ãƒãƒ¼ - ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ  */
      --glass-bg: rgba(255, 255, 255, 0.25);
      --glass-border: rgba(255, 255, 255, 0.35);
      --glass-shadow: rgba(0, 0, 0, 0.1);

      /* ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³ */
      --genre-btn-bg: rgba(255, 255, 255, 0.8);
      --genre-btn-border: rgba(232, 224, 213, 0.6);
      --genre-btn-text: #555555;
      --genre-btn-active-bg: #2D2D2D;
      --genre-btn-active-text: #FFFFFF;

      /* ãƒ•ã‚©ãƒ³ãƒˆ */
      --font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI",
                     "Hiragino Sans", "Noto Sans JP", sans-serif;
      --font-display: 'Playfair Display', serif;

      /* è§’ä¸¸ */
      --radius-card: 16px;
      --radius-button: 24px;
      --radius-search: 50px;
      --radius-tag: 12px;
      --radius-badge: 6px;

      /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
      --grid-gap: 20px;
      --content-max-width: 1400px;
      --section-padding: 24px;

      /* ãƒãƒƒã‚¸è‰² */
      --badge-popular-bg: #E85D5D;
      --badge-new-bg: #5DAD5D;

      /* ã‚¸ãƒ£ãƒ³ãƒ«é…è‰² */
      --genre-rain: #6B8FAD;
      --genre-fire: #C07040;
      --genre-anime: #8B6BAD;
      --genre-study: #7AAD6B;
      --genre-night: #4A5580;
      --genre-chill: #AD8B6B;
    }

    /* ======================================================
       ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å…‰æ²¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
       ====================================================== */
    [data-theme="dark"] {
      --bg-main: #0a0a14;
      --bg-gradient-start: #151528;
      --bg-gradient-mid: #0f0f20;
      --bg-gradient-end: #0a0a14;
      --bg-card: linear-gradient(145deg, rgba(45, 45, 80, 0.8), rgba(30, 30, 55, 0.6));
      --bg-card-solid: rgba(35, 35, 65, 0.75);
      --bg-card-hover: linear-gradient(145deg, rgba(55, 55, 95, 0.9), rgba(40, 40, 70, 0.75));
      --glow-color: rgba(100, 120, 200, 0.15);
      --shine-color: rgba(140, 160, 255, 0.3);
      --highlight-top: rgba(180, 190, 255, 0.15);
      --shadow-soft: rgba(0, 0, 20, 0.4);
      --shadow-medium: rgba(0, 0, 30, 0.5);
      --text-primary: #f0f0f8;
      --text-secondary: #a0a0c0;
      --accent-copper: #E0B080;
      --accent-copper-hover: #F0C090;
      --glass-bg: rgba(40, 40, 70, 0.75);
      --glass-border: rgba(140, 160, 255, 0.25);
      --genre-btn-bg: linear-gradient(145deg, rgba(50, 50, 85, 0.9), rgba(35, 35, 60, 0.7));
      --genre-btn-border: rgba(100, 110, 180, 0.4);
      --genre-btn-text: #c0c0e0;
      --genre-btn-active-bg: linear-gradient(145deg, #8090e0, #6070c0);
      --genre-btn-active-text: #ffffff;
    }

    /* ======================================================
       ãƒªã‚»ãƒƒãƒˆãƒ»ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: var(--font-family);
      background: linear-gradient(
        180deg,
        var(--bg-gradient-start) 0%,
        var(--bg-gradient-mid) 50%,
        var(--bg-gradient-end) 100%
      );
      background-attachment: fixed;
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
    }

    /* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å…‰æ²¢ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(ellipse at 15% 10%, var(--glow-color) 0%, transparent 40%),
        radial-gradient(ellipse at 85% 15%, var(--shine-color) 0%, transparent 35%),
        radial-gradient(ellipse at 75% 85%, var(--glow-color) 0%, transparent 45%),
        radial-gradient(ellipse at 25% 90%, var(--shine-color) 0%, transparent 30%),
        radial-gradient(ellipse at 50% 50%, var(--glow-color) 0%, transparent 60%);
      pointer-events: none;
      z-index: 0;
    }

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èƒŒæ™¯ã‚°ãƒ­ãƒ¼ */
    body::after {
      content: '';
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120%;
      height: 120%;
      background: radial-gradient(ellipse at center, var(--glow-color) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
      opacity: 0.5;
    }

    /* ======================================================
       ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ’ãƒ¼ãƒ­ãƒ¼ä¸Šã«é‡ã­ã‚‹ï¼‰
       ====================================================== */
    .header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 20px 40px;
    }

    .header-inner {
      max-width: var(--content-max-width);
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--text-light);
    }

    .logo-text {
      font-family: var(--font-display);
      font-size: 22px;
      font-weight: 400;
      font-style: italic;
      letter-spacing: 0.5px;
    }

    .header-nav {
      display: flex;
      align-items: center;
      gap: 32px;
    }

    .nav-link {
      color: var(--text-light);
      text-decoration: none;
      font-size: 15px;
      font-weight: 500;
      opacity: 0.9;
      transition: opacity 0.2s;
    }

    .nav-link:hover {
      opacity: 1;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 18px;
    }

    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    .theme-toggle .icon-dark { display: none; }
    [data-theme="dark"] .theme-toggle .icon-light { display: none; }
    [data-theme="dark"] .theme-toggle .icon-dark { display: inline; }

    .lang-toggle {
      display: flex;
      gap: 4px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-button);
      padding: 4px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .lang-btn {
      padding: 6px 12px;
      border: none;
      background: transparent;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .lang-btn:hover {
      color: #fff;
    }

    .lang-btn.active {
      background: rgba(255, 255, 255, 0.9);
      color: #2D2D2D;
    }

    /* ======================================================
       ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³
       ====================================================== */
    .hero-section {
      position: relative;
      height: 70vh;
      min-height: 500px;
      max-height: 800px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .hero-video-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .hero-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .hero-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0.3) 0%,
        rgba(0, 0, 0, 0.2) 50%,
        rgba(0, 0, 0, 0.4) 100%
      );
      z-index: 2;
    }

    .hero-content {
      position: relative;
      z-index: 3;
      text-align: center;
      padding: 0 20px;
      width: 100%;
      max-width: 700px;
    }

    .hero-title {
      font-family: var(--font-display);
      font-size: 72px;
      font-weight: 400;
      font-style: italic;
      color: var(--text-light);
      margin-bottom: 40px;
      text-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
    }

    /* ======================================================
       ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ æ¤œç´¢ãƒãƒ¼
       ====================================================== */
    .search-box {
      display: flex;
      align-items: center;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-search);
      padding: 8px 8px 8px 24px;
      box-shadow: 0 8px 32px var(--glass-shadow);
    }

    .search-icon {
      color: rgba(255, 255, 255, 0.7);
      font-size: 20px;
      margin-right: 12px;
    }

    .search-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-size: 16px;
      font-family: var(--font-family);
      color: var(--text-light);
      min-width: 200px;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .search-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 50px;
      height: 50px;
      background: var(--accent-copper);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      color: white;
      font-size: 20px;
    }

    .search-btn:hover {
      background: var(--accent-copper-hover);
      transform: scale(1.05);
    }

    /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãƒ‰ãƒƒãƒˆï¼ˆè£…é£¾ç”¨ï¼‰ */
    .hero-dots {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-top: 30px;
    }

    .hero-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      cursor: pointer;
      transition: background 0.2s;
    }

    .hero-dot.active {
      background: rgba(255, 255, 255, 0.9);
    }

    /* ======================================================
       ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
       ====================================================== */
    .main-content {
      padding: 40px var(--section-padding);
      max-width: var(--content-max-width);
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .section-title {
      font-family: var(--font-display);
      font-size: 28px;
      font-weight: 400;
      font-style: italic;
      color: var(--text-primary);
      letter-spacing: 0.5px;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
    .genre-filter {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .genre-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      font-family: var(--font-family);
      background: var(--genre-btn-bg);
      backdrop-filter: blur(12px) saturate(150%);
      -webkit-backdrop-filter: blur(12px) saturate(150%);
      border: 1px solid var(--genre-btn-border);
      border-radius: var(--radius-button);
      color: var(--genre-btn-text);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow:
        0 2px 12px var(--shadow-soft),
        inset 0 1px 0 var(--highlight-top);
      position: relative;
      overflow: hidden;
    }

    .genre-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.3), transparent);
      pointer-events: none;
      border-radius: var(--radius-button) var(--radius-button) 0 0;
    }

    .genre-btn:hover {
      border-color: var(--accent-copper);
      box-shadow:
        0 6px 20px var(--shadow-medium),
        inset 0 1px 0 var(--shine-color);
      transform: translateY(-2px);
    }

    .genre-btn.active {
      background: var(--genre-btn-active-bg);
      border-color: transparent;
      color: var(--genre-btn-active-text);
      box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    [data-theme="dark"] .genre-btn::before {
      background: linear-gradient(180deg, rgba(180, 190, 255, 0.15), transparent);
    }

    .genre-btn .emoji {
      font-size: 16px;
    }

    /* ======================================================
       ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰
       ====================================================== */
    .cards-area {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--grid-gap);
    }

    .empty-message {
      grid-column: 1 / -1;
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
      font-size: 15px;
    }

    .loading-state {
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      gap: 16px;
    }

    .loading-spinner {
      width: 36px;
      height: 36px;
      border: 3px solid var(--genre-btn-border);
      border-top-color: var(--accent-copper);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ======================================================
       ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ 
       ====================================================== */
    .package-card {
      position: relative;
      border-radius: var(--radius-card);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      background: var(--bg-card);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      border: 1px solid var(--highlight-top);
      box-shadow:
        0 4px 20px var(--shadow-soft),
        0 8px 40px var(--shadow-medium),
        inset 0 1px 0 var(--highlight-top),
        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
    }

    /* ã‚«ãƒ¼ãƒ‰ä¸Šéƒ¨ã®ã‚·ãƒ£ã‚¤ãƒ³åŠ¹æœ */
    .package-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(
        180deg,
        var(--highlight-top) 0%,
        transparent 100%
      );
      pointer-events: none;
      z-index: 1;
      opacity: 0.5;
      border-radius: var(--radius-card) var(--radius-card) 0 0;
    }

    .package-card:hover {
      transform: translateY(-8px) scale(1.02);
      background: var(--bg-card-hover);
      box-shadow:
        0 16px 48px var(--shadow-medium),
        0 24px 64px var(--shadow-soft),
        inset 0 1px 0 var(--shine-color),
        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
    }

    .package-card:hover::before {
      opacity: 0.8;
    }

    /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ ã‚«ãƒ¼ãƒ‰ */
    [data-theme="dark"] .package-card {
      border: 1px solid rgba(140, 160, 255, 0.2);
      box-shadow:
        0 4px 20px rgba(0, 0, 30, 0.5),
        0 8px 40px rgba(0, 0, 50, 0.3),
        inset 0 1px 0 rgba(180, 190, 255, 0.1),
        0 0 60px rgba(100, 120, 200, 0.05);
    }

    [data-theme="dark"] .package-card::before {
      background: linear-gradient(
        180deg,
        rgba(140, 160, 255, 0.1) 0%,
        transparent 100%
      );
    }

    [data-theme="dark"] .package-card:hover {
      box-shadow:
        0 16px 48px rgba(0, 0, 50, 0.5),
        0 24px 64px rgba(100, 120, 200, 0.15),
        inset 0 1px 0 rgba(180, 190, 255, 0.2),
        0 0 80px rgba(100, 120, 200, 0.1);
    }

    .card-thumbnail {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯” */
      overflow: hidden;
      background: #2a2a2a;
      border-radius: 16px;
    }

    .card-thumbnail img,
    .card-thumbnail video,
    .card-thumbnail iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border: none;
      border-radius: 16px;
    }

    /* å†ç”Ÿãƒœã‚¿ãƒ³ - å·¦ä¸‹ã«é…ç½® */
    .play-overlay {
      position: absolute;
      bottom: 12px;
      left: 12px;
      width: auto;
      height: auto;
      background: transparent;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    .play-icon {
      width: 36px;
      height: 36px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: #333;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease;
    }

    .package-card:hover .play-icon {
      transform: scale(1.1);
    }

    .card-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      border-radius: 16px;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼é…è‰² */
    .card-placeholder[data-genre="rain"] {
      background: linear-gradient(135deg, #6B8FAD 0%, #8BAFC8 100%);
    }
    .card-placeholder[data-genre="fire"] {
      background: linear-gradient(135deg, #C07040 0%, #D49060 100%);
    }
    .card-placeholder[data-genre="anime"] {
      background: linear-gradient(135deg, #8B6BAD 0%, #A88BC8 100%);
    }
    .card-placeholder[data-genre="study"] {
      background: linear-gradient(135deg, #7AAD6B 0%, #98C88B 100%);
    }
    .card-placeholder[data-genre="night"] {
      background: linear-gradient(135deg, #4A5580 0%, #6A75A0 100%);
    }
    .card-placeholder[data-genre="chill"] {
      background: linear-gradient(135deg, #AD8B6B 0%, #C8A88B 100%);
    }

    /* ãƒãƒƒã‚¸ - éè¡¨ç¤ºï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ */
    .card-badge {
      display: none;
    }

    /* ã‚«ãƒ¼ãƒ‰æœ¬æ–‡ - ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ */
    .card-body {
      padding: 12px 4px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .card-info {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 0;
    }

    /* ã‚¿ã‚°ã¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã¯éè¡¨ç¤ºï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ */
    .card-tags {
      display: none;
    }

    .card-download-btn {
      display: none;
    }

    /* ======================================================
       ãƒ¢ãƒ¼ãƒ€ãƒ«
       ====================================================== */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      padding: 20px;
      overflow-y: auto;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--bg-card);
      border-radius: var(--radius-card);
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 40px;
      height: 40px;
      background: rgba(0, 0, 0, 0.6);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-video {
      position: relative;
      width: 100%;
      padding-top: 56.25%;
      background: #000;
      border-radius: var(--radius-card) var(--radius-card) 0 0;
      overflow: hidden;
    }

    .modal-video iframe,
    .modal-video video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .modal-video .modal-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
    }

    .modal-body {
      padding: 24px;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .modal-info {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .modal-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .modal-download-btn {
      width: 100%;
      padding: 16px 24px;
      background-color: var(--accent-copper);
      border: none;
      border-radius: var(--radius-button);
      font-size: 16px;
      font-weight: 600;
      font-family: var(--font-family);
      color: #FFFFFF;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .modal-download-btn:hover {
      background-color: var(--accent-copper-hover);
    }

    /* ======================================================
       ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«
       ====================================================== */
    .download-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .download-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .download-content {
      text-align: center;
      color: #fff;
      max-width: 420px;
      padding: 40px;
      background: linear-gradient(145deg, rgba(50, 50, 70, 0.9), rgba(30, 30, 45, 0.95));
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 24px 64px rgba(0, 0, 0, 0.5);
    }

    .download-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }

    .download-title {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #fff;
    }

    .download-file-info {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 20px;
    }

    .download-file-name {
      font-size: 16px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 6px;
    }

    .download-file-size {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.6);
    }

    .download-message {
      font-size: 15px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.7;
      margin-bottom: 20px;
    }

    .download-message strong {
      color: var(--accent-copper);
    }

    .download-notice {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      background: rgba(212, 165, 116, 0.15);
      border: 1px solid rgba(212, 165, 116, 0.3);
      border-radius: 12px;
      padding: 14px 16px;
      margin-bottom: 24px;
      text-align: left;
    }

    .download-notice .notice-icon {
      font-size: 18px;
      flex-shrink: 0;
    }

    .download-notice span:last-child {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.5;
    }

    .download-start-btn {
      width: 100%;
      padding: 16px 24px;
      background: linear-gradient(135deg, var(--accent-copper), var(--accent-warm));
      border: none;
      border-radius: var(--radius-button);
      font-size: 16px;
      font-weight: 600;
      font-family: var(--font-family);
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 12px;
      box-shadow: 0 4px 16px rgba(212, 165, 116, 0.3);
    }

    .download-start-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(212, 165, 116, 0.4);
    }

    .download-close-btn {
      padding: 12px 32px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-button);
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      font-family: var(--font-family);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .download-close-btn:hover {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.3);
      color: #fff;
    }

    /* ======================================================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–
       ====================================================== */
    @media (max-width: 1199px) {
      .cards-area {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 899px) {
      .cards-area {
        grid-template-columns: repeat(2, 1fr);
      }

      .hero-title {
        font-size: 56px;
      }

      .header-nav {
        display: none;
      }
    }

    @media (max-width: 600px) {
      .cards-area {
        grid-template-columns: 1fr;
      }

      .hero-section {
        height: 60vh;
        min-height: 400px;
      }

      .hero-title {
        font-size: 42px;
        margin-bottom: 24px;
      }

      .search-box {
        padding: 6px 6px 6px 16px;
      }

      .search-input {
        font-size: 14px;
        min-width: 150px;
      }

      .search-btn {
        width: 44px;
        height: 44px;
      }

      .header {
        padding: 16px 20px;
      }

      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
      }

      .genre-filter {
        width: 100%;
        overflow-x: auto;
        flex-wrap: nowrap;
        padding-bottom: 8px;
      }

      .genre-btn {
        flex-shrink: 0;
      }
    }

    @media (max-width: 479px) {
      .hero-title {
        font-size: 36px;
      }

      .logo-text {
        font-size: 16px;
      }

      .main-content {
        padding: 24px 16px;
      }
    }
  </style>
</head>
<body>
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ’ãƒ¼ãƒ­ãƒ¼ä¸Šã«é‡ãªã‚‹ï¼‰ -->
  <header class="header">
    <div class="header-inner">
      <a href="#" class="logo">
        <span class="logo-text">Lo-Fi Templates</span>
      </a>

      <nav class="header-nav">
        <a href="#" class="nav-link" data-i18n="nav.home">ãƒ›ãƒ¼ãƒ </a>
        <a href="#packages" class="nav-link" data-i18n="nav.packages">ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</a>
        <a href="#" class="nav-link" data-i18n="nav.about">æ¦‚è¦</a>
      </nav>

      <div class="header-controls">
        <button type="button" class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
          <span class="icon-light">â˜€ï¸</span>
          <span class="icon-dark">ğŸŒ™</span>
        </button>
        <div class="lang-toggle">
          <button type="button" class="lang-btn active" data-lang="ja">JA</button>
          <button type="button" class="lang-btn" data-lang="en">EN</button>
        </div>
      </div>
    </div>
  </header>

  <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <section class="hero-section">
    <div class="hero-video-container">
      <video class="hero-video" autoplay muted loop playsinline>
        <source src="fireplace-loop.mp4" type="video/mp4">
      </video>
    </div>
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h1 class="hero-title">Search</h1>
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input
          type="text"
          class="search-input"
          id="search-input"
          placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢"
          data-i18n-placeholder="searchPlaceholder"
        >
        <button type="button" class="search-btn" aria-label="Search">
          ğŸ”
        </button>
      </div>
      <div class="hero-dots">
        <span class="hero-dot active"></span>
        <span class="hero-dot"></span>
        <span class="hero-dot"></span>
        <span class="hero-dot"></span>
      </div>
    </div>
  </section>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <main class="main-content" id="packages">
    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="section-header">
      <h2 class="section-title" data-i18n="sectionTitle">Lo-Fi ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>
      <div class="genre-filter" id="genre-filter">
        <button type="button" class="genre-btn" data-genre="rain">
          <span class="emoji">ğŸŒ§ï¸</span>
          <span data-i18n="genres.rain">é›¨</span>
        </button>
        <button type="button" class="genre-btn" data-genre="fire">
          <span class="emoji">ğŸ”¥</span>
          <span data-i18n="genres.fire">ç«</span>
        </button>
        <button type="button" class="genre-btn" data-genre="anime">
          <span class="emoji">ğŸ¬</span>
          <span data-i18n="genres.anime">ã‚¢ãƒ‹ãƒ¡</span>
        </button>
        <button type="button" class="genre-btn" data-genre="study">
          <span class="emoji">ğŸ“š</span>
          <span data-i18n="genres.study">å‹‰å¼·</span>
        </button>
        <button type="button" class="genre-btn" data-genre="night">
          <span class="emoji">ğŸŒ™</span>
          <span data-i18n="genres.night">å¤œ</span>
        </button>
        <button type="button" class="genre-btn" data-genre="chill">
          <span class="emoji">â˜•</span>
          <span data-i18n="genres.chill">ãƒãƒ«</span>
        </button>
      </div>
    </div>

    <!-- ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ -->
    <section class="cards-area" id="cards-container">
      <!-- JavaScriptã§å‹•çš„ã«æç”» -->
    </section>
  </main>

  <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal-content">
      <button type="button" class="modal-close" id="modal-close">&times;</button>
      <div class="modal-video" id="modal-video"></div>
      <div class="modal-body">
        <h2 class="modal-title" id="modal-title"></h2>
        <div class="modal-info" id="modal-info"></div>
        <div class="modal-tags" id="modal-tags"></div>
        <button type="button" class="modal-download-btn" id="modal-download-btn">
          ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        </button>
      </div>
    </div>
  </div>

  <!-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="download-overlay" id="download-overlay">
    <div class="download-content">
      <div class="download-icon">ğŸ“¥</div>
      <h2 class="download-title" id="download-title">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®ç¢ºèª</h2>
      <div class="download-file-info" id="download-file-info">
        <div class="download-file-name" id="download-file-name">ç„šãç«Ã—Lo-Fi ç™’ã—ç³»</div>
        <div class="download-file-size" id="download-file-size">ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 1.27GB</div>
      </div>
      <p class="download-message" id="download-message">
        ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤§å®¹é‡ã®ãŸã‚ã€<br>
        <strong>Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®ç¢ºèªç”»é¢</strong>ãŒ<br>
        åˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã™ã€‚
      </p>
      <div class="download-notice">
        <span class="notice-icon">â„¹ï¸</span>
        <span>ç¢ºèªç”»é¢ã§ã€Œã“ã®ã¾ã¾ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚’<br>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</span>
      </div>
      <button type="button" class="download-start-btn" id="download-start-btn">
        ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹
      </button>
      <button type="button" class="download-close-btn" id="download-close-btn">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
    </div>
  </div>

  <!-- éè¡¨ç¤ºiframeï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ï¼‰ -->
  <iframe id="download-frame" style="display: none;"></iframe>

  <!-- JavaScript -->
  <script type="module">
    // Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy }
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";
    import { getStorage, ref, getDownloadURL }
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-storage.js";
    import { getAnalytics, logEvent }
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-analytics.js";

    // Firebaseè¨­å®š
    const FIREBASE_CONFIG = {
      apiKey: "AIzaSyDODb4VhipgcwVJeP2tG6MGsJNragThfEo",
      authDomain: "lofi-video-templates.firebaseapp.com",
      projectId: "lofi-video-templates",
      storageBucket: "lofi-video-templates.firebasestorage.app",
      messagingSenderId: "224238399039",
      appId: "1:224238399039:web:321f1e4a2fea493840128a",
      measurementId: "G-8BPBNLDF2G"
    };

    let db = null;
    let storage = null;
    let analytics = null;

    // ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°é™¤å¤–ï¼‰
    // URLã« ?admin=true ã‚’è¿½åŠ ã™ã‚‹ã¨ãã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¾ã™
    // è§£é™¤ã™ã‚‹ã«ã¯ ?admin=false ã‚’è¿½åŠ ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„
    function checkAdminMode() {
      const urlParams = new URLSearchParams(window.location.search);
      const adminParam = urlParams.get('admin');
      if (adminParam === 'true') {
        localStorage.setItem('lofi_admin_mode', 'true');
        console.log('ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰: ONï¼ˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ç„¡åŠ¹ï¼‰');
      } else if (adminParam === 'false') {
        localStorage.removeItem('lofi_admin_mode');
        console.log('ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰: OFFï¼ˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æœ‰åŠ¹ï¼‰');
      }
      return localStorage.getItem('lofi_admin_mode') === 'true';
    }

    const isAdminMode = checkAdminMode();

    // ã‚¸ãƒ£ãƒ³ãƒ«çµµæ–‡å­—
    const GENRE_EMOJI = {
      rain: 'ğŸŒ§ï¸',
      fire: 'ğŸ”¥',
      anime: 'ğŸ¬',
      study: 'ğŸ“š',
      night: 'ğŸŒ™',
      chill: 'â˜•'
    };

    // i18nè¾æ›¸
    const I18N = {
      ja: {
        searchPlaceholder: 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢',
        sectionTitle: 'Lo-Fi ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸',
        nav: { home: 'ãƒ›ãƒ¼ãƒ ', packages: 'ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸', about: 'æ¦‚è¦' },
        genres: { rain: 'é›¨', fire: 'ç«', anime: 'ã‚¢ãƒ‹ãƒ¡', study: 'å‹‰å¼·', night: 'å¤œ', chill: 'ãƒãƒ«' },
        badge: { popular: 'äººæ°—', new: 'æ–°ä½œ' },
        downloadBtn: 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
        emptyMessage: 'è©²å½“ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã›ã‚“',
        loading: 'èª­ã¿è¾¼ã¿ä¸­...',
        duration: 'åˆ†',
        comingSoon: 'æº–å‚™ä¸­ã§ã™ã€‚ã‚‚ã†ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚',
        download: {
          title: 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®ç¢ºèª',
          fileSize: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º',
          message: 'ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤§å®¹é‡ã®ãŸã‚ã€<br><strong>Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®ç¢ºèªç”»é¢</strong>ãŒ<br>åˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã™ã€‚',
          notice: 'ç¢ºèªç”»é¢ã§ã€Œã“ã®ã¾ã¾ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ã‚’<br>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„',
          start: 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹',
          cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'
        }
      },
      en: {
        searchPlaceholder: 'Search by keyword',
        sectionTitle: 'Lo-Fi Packages',
        nav: { home: 'Home', packages: 'Packages', about: 'About' },
        genres: { rain: 'Rain', fire: 'Fire', anime: 'Anime', study: 'Study', night: 'Night', chill: 'Chill' },
        badge: { popular: 'Popular', new: 'New' },
        downloadBtn: 'Download',
        emptyMessage: 'No packages found',
        loading: 'Loading...',
        duration: 'min',
        comingSoon: 'Coming soon. Please wait.',
        download: {
          title: 'Confirm Download',
          fileSize: 'File size',
          message: 'Due to the large file size,<br>a <strong>Google Drive confirmation page</strong><br>will open in a new tab.',
          notice: 'Click "Download anyway" on the<br>confirmation page',
          start: 'Start Download',
          cancel: 'Cancel'
        }
      }
    };

    // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿
    const LOCAL_PACKAGES = [
      {
        id: 'rain-lofi-work',
        title_ja: 'é›¨éŸ³Ã—Lo-Fi ä½œæ¥­ç”¨',
        title_en: 'Rain Ã— Lo-Fi Work',
        genres: ['rain', 'study'],
        durationMinutes: 60,
        size: '1.2GB',
        badge: 'popular',
        order: 1
      },
      {
        id: 'fire-lofi-healing',
        title_ja: 'ç„šãç«Ã—Lo-Fi ç™’ã—ç³»',
        title_en: 'Bonfire Ã— Lo-Fi Healing',
        genres: ['fire', 'chill'],
        durationMinutes: 60,
        size: '1.27GB',
        badge: 'new',
        youtubeId: 'TKbyXrcEpuQ',
        downloadUrl: 'https://drive.google.com/uc?export=download&confirm=t&id=1Bd4ZEjZEHPeUt0TLCSpmMedo1wTaU6KA',
        order: 2
      },
      {
        id: 'night-city-lofi',
        title_ja: 'å¤œã®è¡—Ã—Lo-Fi æ•£æ­©ç”¨',
        title_en: 'Night City Ã— Lo-Fi Walk',
        genres: ['night', 'anime'],
        durationMinutes: 60,
        size: '1.5GB',
        badge: 'popular',
        order: 3
      },
      {
        id: 'cafe-lofi-reading',
        title_ja: 'ã‚«ãƒ•ã‚§Ã—Lo-Fi èª­æ›¸ç”¨',
        title_en: 'CafÃ© Ã— Lo-Fi Reading',
        genres: ['rain', 'study'],
        durationMinutes: 60,
        size: '1.1GB',
        badge: 'new',
        order: 4
      },
      {
        id: 'sakura-lofi-spring',
        title_ja: 'æ¡œÃ—Lo-Fi æ˜¥ã®ä½œæ¥­ç”¨',
        title_en: 'Sakura Ã— Lo-Fi Spring',
        genres: ['chill', 'study'],
        durationMinutes: 60,
        size: '1.3GB',
        badge: 'popular',
        order: 5
      },
      {
        id: 'forest-lofi-nature',
        title_ja: 'æ£®æ—Ã—Lo-Fi è‡ªç„¶éŸ³',
        title_en: 'Forest Ã— Lo-Fi Nature',
        genres: ['rain', 'chill'],
        durationMinutes: 60,
        size: '1.0GB',
        badge: 'new',
        order: 6
      },
      {
        id: 'ocean-lofi-waves',
        title_ja: 'æµ·Ã—Lo-Fi æ³¢ã®éŸ³',
        title_en: 'Ocean Ã— Lo-Fi Waves',
        genres: ['chill', 'night'],
        durationMinutes: 60,
        size: '1.4GB',
        badge: 'popular',
        order: 7
      },
      {
        id: 'bedroom-lofi-sleep',
        title_ja: 'ãƒ™ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ Ã—Lo-Fi ç¡çœ ç”¨',
        title_en: 'Bedroom Ã— Lo-Fi Sleep',
        genres: ['night', 'chill'],
        durationMinutes: 60,
        size: '1.1GB',
        badge: 'new',
        order: 8
      }
    ];

    // çŠ¶æ…‹
    const state = {
      packages: [],
      filteredPackages: [],
      selectedGenres: [],
      searchQuery: '',
      currentLang: 'ja',
      currentTheme: 'light',
      isLoading: false
    };

    // Firebase
    function isFirebaseConfigured() {
      return FIREBASE_CONFIG.apiKey && FIREBASE_CONFIG.projectId;
    }

    function initializeFirebase() {
      if (!isFirebaseConfigured()) return false;
      try {
        const app = initializeApp(FIREBASE_CONFIG);
        db = getFirestore(app);
        storage = getStorage(app);
        // AnalyticsåˆæœŸåŒ–
        if (FIREBASE_CONFIG.measurementId) {
          analytics = getAnalytics(app);
          // ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã‚’è¨˜éŒ²
          trackEvent('page_view', { page_title: document.title });
        }
        return true;
      } catch (e) {
        console.warn('FirebaseåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', e);
        return false;
      }
    }

    // ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
    function trackEvent(eventName, params = {}) {
      // ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¹ã‚­ãƒƒãƒ—
      if (isAdminMode) {
        console.log(`ğŸ“Š [ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°é™¤å¤–] ${eventName}:`, params);
        return;
      }
      if (analytics) {
        try {
          logEvent(analytics, eventName, params);
        } catch (e) {
          // ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ï¼ˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã®å¤±æ•—ã§ã‚¢ãƒ—ãƒªã‚’æ­¢ã‚ãªã„ï¼‰
        }
      }
    }

    async function loadPackages() {
      if (isFirebaseConfigured() && db) {
        try {
          const snapshot = await getDocs(query(collection(db, 'packages'), orderBy('order')));
          if (!snapshot.empty) {
            return snapshot.docs.map(doc => doc.data()).filter(pkg => pkg.visible !== false);
          }
        } catch (e) {}
      }
      return LOCAL_PACKAGES;
    }

    async function resolveThumbnail(pkg) {
      if (pkg.thumbnailPath && isFirebaseConfigured() && storage) {
        try {
          return await getDownloadURL(ref(storage, pkg.thumbnailPath));
        } catch (e) {}
      }
      return null;
    }

    async function resolvePreview(pkg) {
      if (pkg.previewUrl) return pkg.previewUrl;
      if (pkg.previewPath && isFirebaseConfigured() && storage) {
        try {
          return await getDownloadURL(ref(storage, pkg.previewPath));
        } catch (e) {}
      }
      return null;
    }

    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«è¦ç´ 
    const downloadOverlay = document.getElementById('download-overlay');
    const downloadTitle = document.getElementById('download-title');
    const downloadFileName = document.getElementById('download-file-name');
    const downloadFileSize = document.getElementById('download-file-size');
    const downloadMessage = document.getElementById('download-message');
    const downloadStartBtn = document.getElementById('download-start-btn');
    const downloadCloseBtn = document.getElementById('download-close-btn');

    // ç¾åœ¨ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æƒ…å ±ã‚’ä¿å­˜
    let pendingDownload = null;

    function showDownloadModal(pkg, downloadUrl) {
      const title = state.currentLang === 'ja' ? pkg.title_ja : pkg.title_en;

      // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…å®¹ã‚’æ›´æ–°
      downloadTitle.textContent = t('download.title');
      downloadFileName.textContent = title;
      downloadFileSize.textContent = `${t('download.fileSize')}: ${pkg.size || '1.0GB'}`;
      downloadMessage.innerHTML = t('download.message');
      downloadStartBtn.textContent = t('download.start');
      downloadCloseBtn.textContent = t('download.cancel');

      // ç¢ºèªç”»é¢ã®æ³¨æ„æ›¸ãã‚‚æ›´æ–°
      const noticeText = document.querySelector('.download-notice span:last-child');
      if (noticeText) noticeText.innerHTML = t('download.notice');

      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æƒ…å ±ã‚’ä¿å­˜
      pendingDownload = { pkg, downloadUrl, title };

      downloadOverlay.classList.add('active');
    }

    function hideDownloadModal() {
      downloadOverlay.classList.remove('active');
      pendingDownload = null;
    }

    function startDownload() {
      if (!pendingDownload) return;

      const { pkg, downloadUrl, title } = pendingDownload;

      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨˜éŒ²
      trackEvent('download_click', {
        package_id: pkg.id,
        package_title: title,
        file_size: pkg.size || 'unknown'
      });

      // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
      hideDownloadModal();

      // æ–°ã—ã„ã‚¿ãƒ–ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’é–‹ã
      window.open(downloadUrl, '_blank');
    }

    async function handleDownload(pkgId) {
      const pkg = state.packages.find(p => p.id === pkgId);
      if (!pkg) return;

      if (pkg.downloadUrl) {
        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
        showDownloadModal(pkg, pkg.downloadUrl);
        return;
      }

      if (pkg.downloadPath && isFirebaseConfigured() && storage) {
        try {
          const url = await getDownloadURL(ref(storage, pkg.downloadPath));
          // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
          showDownloadModal(pkg, url);
          return;
        } catch (e) {}
      }

      alert(t('comingSoon'));
    }

    // DOM
    const cardsContainer = document.getElementById('cards-container');
    const searchInput = document.getElementById('search-input');
    const genreFilter = document.getElementById('genre-filter');
    const genreButtons = genreFilter.querySelectorAll('.genre-btn');
    const langButtons = document.querySelectorAll('.lang-btn');
    const themeToggle = document.getElementById('theme-toggle');
    const modalOverlay = document.getElementById('modal-overlay');
    const modalClose = document.getElementById('modal-close');
    const modalVideo = document.getElementById('modal-video');
    const modalTitle = document.getElementById('modal-title');
    const modalInfo = document.getElementById('modal-info');
    const modalTags = document.getElementById('modal-tags');
    const modalDownloadBtn = document.getElementById('modal-download-btn');

    // i18n
    function t(key) {
      const keys = key.split('.');
      let value = I18N[state.currentLang];
      for (const k of keys) value = value?.[k];
      return value || key;
    }

    function setLanguage(lang) {
      if (lang === state.currentLang) return;
      state.currentLang = lang;
      document.documentElement.lang = lang;
      langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === lang));
      applyLanguageToUI();
      renderCards(state.filteredPackages);
    }

    function applyLanguageToUI() {
      searchInput.placeholder = t('searchPlaceholder');
      document.querySelector('[data-i18n="sectionTitle"]').textContent = t('sectionTitle');
      document.querySelectorAll('[data-i18n^="nav."]').forEach(el => {
        const key = el.dataset.i18n;
        el.textContent = t(key);
      });
      genreButtons.forEach(btn => {
        const genre = btn.dataset.genre;
        const labelSpan = btn.querySelector('[data-i18n]');
        if (labelSpan) labelSpan.textContent = t(`genres.${genre}`);
      });
    }

    // ãƒ†ãƒ¼ãƒ
    function setTheme(theme) {
      if (theme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
      } else {
        document.documentElement.removeAttribute('data-theme');
      }
      localStorage.setItem('theme', theme);
      state.currentTheme = theme;
    }

    function toggleTheme() {
      setTheme(state.currentTheme === 'dark' ? 'light' : 'dark');
    }

    function loadSavedTheme() {
      const saved = localStorage.getItem('theme');
      if (saved) { setTheme(saved); return; }
      if (window.matchMedia?.('(prefers-color-scheme: dark)').matches) { setTheme('dark'); return; }
      setTheme('light');
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«
    let currentModalPkgId = null;

    function openModal(pkgId) {
      const pkg = state.packages.find(p => p.id === pkgId);
      if (!pkg) return;
      currentModalPkgId = pkgId;

      const title = state.currentLang === 'ja' ? pkg.title_ja : pkg.title_en;

      // ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨˜éŒ²
      trackEvent('modal_open', {
        package_id: pkgId,
        package_title: title,
        genres: pkg.genres.join(',')
      });
      modalTitle.textContent = title;
      modalInfo.textContent = `â± ${pkg.durationMinutes || 60}${t('duration')} ğŸ’¾ ${pkg.size || '1.0GB'}`;
      modalTags.innerHTML = pkg.genres.map(g => `<span class="modal-tag card-tag" data-genre="${g}">${t(`genres.${g}`)}</span>`).join('');
      modalDownloadBtn.textContent = t('downloadBtn');

      const primaryGenre = pkg.genres[0] || 'chill';
      const emoji = GENRE_EMOJI[primaryGenre] || 'ğŸµ';

      if (pkg.youtubeId) {
        modalVideo.innerHTML = `<iframe src="https://www.youtube.com/embed/${pkg.youtubeId}?rel=0&modestbranding=1&autoplay=1" title="${title}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
      } else if (pkg.resolvedPreviewUrl) {
        modalVideo.innerHTML = `<video controls autoplay loop><source src="${pkg.resolvedPreviewUrl}" type="video/mp4"></video>`;
      } else {
        modalVideo.innerHTML = `<div class="modal-placeholder card-placeholder" data-genre="${primaryGenre}">${emoji}</div>`;
      }

      modalOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      modalOverlay.classList.remove('active');
      document.body.style.overflow = '';
      currentModalPkgId = null;
      modalVideo.innerHTML = '';
    }

    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    function applyFilters() {
      let filtered = [...state.packages];
      if (state.selectedGenres.length > 0) {
        filtered = filtered.filter(pkg => state.selectedGenres.every(g => pkg.genres.includes(g)));
      }
      if (state.searchQuery.trim()) {
        const q = state.searchQuery.toLowerCase().trim();
        filtered = filtered.filter(pkg => pkg.title_ja.toLowerCase().includes(q) || pkg.title_en.toLowerCase().includes(q));
      }
      state.filteredPackages = filtered;
      renderCards(state.filteredPackages);
    }

    function toggleGenre(genre) {
      const idx = state.selectedGenres.indexOf(genre);
      if (idx === -1) state.selectedGenres.push(genre);
      else state.selectedGenres.splice(idx, 1);
      updateGenreButtonStates();
      applyFilters();
      // ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨˜éŒ²
      trackEvent('filter_genre', {
        genre: genre,
        selected_genres: state.selectedGenres.join(','),
        action: idx === -1 ? 'add' : 'remove'
      });
    }

    function updateGenreButtonStates() {
      genreButtons.forEach(btn => btn.classList.toggle('active', state.selectedGenres.includes(btn.dataset.genre)));
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆ
    // æ¤œç´¢ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç”¨
    let searchDebounceTimer = null;

    function setupEventListeners() {
      searchInput.addEventListener('input', e => {
        state.searchQuery = e.target.value;
        applyFilters();
        // æ¤œç´¢ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ‡ãƒã‚¦ãƒ³ã‚¹ï¼ˆ500mså¾Œã«è¨˜éŒ²ï¼‰
        clearTimeout(searchDebounceTimer);
        if (e.target.value.trim()) {
          searchDebounceTimer = setTimeout(() => {
            trackEvent('search', {
              search_term: e.target.value.trim(),
              results_count: state.filteredPackages.length
            });
          }, 500);
        }
      });
      genreButtons.forEach(btn => btn.addEventListener('click', () => toggleGenre(btn.dataset.genre)));
      langButtons.forEach(btn => btn.addEventListener('click', () => setLanguage(btn.dataset.lang)));
      themeToggle.addEventListener('click', toggleTheme);
      modalClose.addEventListener('click', closeModal);
      modalOverlay.addEventListener('click', e => { if (e.target === modalOverlay) closeModal(); });
      document.addEventListener('keydown', e => { if (e.key === 'Escape' && modalOverlay.classList.contains('active')) closeModal(); });
      modalDownloadBtn.addEventListener('click', () => { if (currentModalPkgId) handleDownload(currentModalPkgId); });
      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã®ãƒœã‚¿ãƒ³
      downloadStartBtn.addEventListener('click', startDownload);
      downloadCloseBtn.addEventListener('click', hideDownloadModal);
      downloadOverlay.addEventListener('click', e => { if (e.target === downloadOverlay) hideDownloadModal(); });
    }

    // æç”»
    function showLoading() {
      cardsContainer.innerHTML = `<div class="loading-state"><div class="loading-spinner"></div><div>${t('loading')}</div></div>`;
    }

    function renderCards(packages) {
      cardsContainer.innerHTML = '';
      if (packages.length === 0) {
        cardsContainer.innerHTML = `<div class="empty-message">${t('emptyMessage')}</div>`;
        return;
      }
      packages.forEach(pkg => cardsContainer.appendChild(createCardElement(pkg)));
    }

    function createCardElement(pkg) {
      const card = document.createElement('article');
      card.className = 'package-card';
      card.dataset.id = pkg.id;

      const title = state.currentLang === 'ja' ? pkg.title_ja : pkg.title_en;
      const primaryGenre = pkg.genres[0] || 'chill';
      const emoji = GENRE_EMOJI[primaryGenre] || 'ğŸµ';

      let thumbnailHtml;
      let hasVideo = false;
      const playIconHtml = `<div class="play-overlay"><div class="play-icon">â–¶</div></div>`;

      if (pkg.youtubeId) {
        // YouTubeã‚µãƒ ãƒã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼ˆåŸ‹ã‚è¾¼ã¿ã§ã¯ãªãç”»åƒï¼‰
        thumbnailHtml = `<img src="https://img.youtube.com/vi/${pkg.youtubeId}/maxresdefault.jpg" alt="${title}" loading="lazy">${playIconHtml}`;
      } else if (pkg.resolvedPreviewUrl) {
        hasVideo = true;
        thumbnailHtml = `<video muted loop playsinline preload="metadata"><source src="${pkg.resolvedPreviewUrl}" type="video/mp4"></video>${playIconHtml}`;
      } else if (pkg.resolvedThumbnailUrl) {
        thumbnailHtml = `<img src="${pkg.resolvedThumbnailUrl}" alt="${title}" loading="lazy">${playIconHtml}`;
      } else {
        thumbnailHtml = `<div class="card-placeholder" data-genre="${primaryGenre}">${emoji}</div>${playIconHtml}`;
      }

      card.innerHTML = `
        <div class="card-thumbnail">${thumbnailHtml}</div>
        <div class="card-body">
          <h3 class="card-title">${title}</h3>
          <div class="card-info">${pkg.durationMinutes || 60}${t('duration')}</div>
        </div>
      `;

      if (hasVideo) {
        const video = card.querySelector('video');
        video.addEventListener('error', () => {
          card.querySelector('.card-thumbnail').innerHTML = `<div class="card-placeholder" data-genre="${primaryGenre}">${emoji}</div>${playIconHtml}`;
        });
        card.addEventListener('mouseenter', () => video.play().catch(() => {}));
        card.addEventListener('mouseleave', () => { video.pause(); video.currentTime = 0; });
      }

      card.addEventListener('click', () => openModal(pkg.id));

      return card;
    }

    async function resolveAllThumbnails(packages) {
      return Promise.all(packages.map(async pkg => ({
        ...pkg,
        resolvedThumbnailUrl: await resolveThumbnail(pkg),
        resolvedPreviewUrl: await resolvePreview(pkg)
      })));
    }

    // åˆæœŸåŒ–
    async function init() {
      loadSavedTheme();
      setupEventListeners();
      initializeFirebase();
      state.isLoading = true;
      showLoading();

      try {
        const packages = await loadPackages();
        state.packages = await resolveAllThumbnails(packages);
        state.filteredPackages = [...state.packages];
        state.isLoading = false;
        renderCards(state.filteredPackages);
      } catch (e) {
        state.isLoading = false;
        if (state.packages.length === 0) {
          state.packages = LOCAL_PACKAGES;
          state.filteredPackages = [...state.packages];
          renderCards(state.filteredPackages);
        }
      }
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>

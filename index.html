<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lo-Fi Video Templates - Free Lo-Fi Video Backgrounds</title>
  <style>
    /* ======================================================
       ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆCSSå¤‰æ•°ï¼‰
       ====================================================== */
    :root {
      /* èƒŒæ™¯è‰² */
      --bg-main: #F5F3EF;
      --bg-card: #FFFFFF;
      --bg-header: #F5F3EF;

      /* ãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --text-primary: #2D2D2D;
      --text-secondary: #888888;

      /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */
      --accent-blue: #5B9BD5;
      --accent-blue-hover: #4A8AC4;

      /* æ¤œç´¢ãƒãƒ¼ */
      --search-bg: #FFFFFF;
      --search-border: #E0DDD8;
      --search-border-focus: #5B9BD5;

      /* ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³ */
      --genre-btn-bg: #FFFFFF;
      --genre-btn-border: #E0DDD8;
      --genre-btn-text: #555555;
      --genre-btn-active-bg: #2D2D2D;
      --genre-btn-active-text: #FFFFFF;

      /* ãƒ•ã‚©ãƒ³ãƒˆ */
      --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                     "Hiragino Sans", "Noto Sans JP", sans-serif;

      /* è§’ä¸¸ */
      --radius-card: 12px;
      --radius-button: 20px;
      --radius-search: 24px;
      --radius-tag: 12px;
      --radius-badge: 6px;

      /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
      --grid-gap: 24px;
      --content-max-width: 1280px;
      --section-padding: 24px;

      /* ãƒãƒƒã‚¸è‰² */
      --badge-popular-bg: #E85D5D;
      --badge-new-bg: #5DAD5D;

      /* ã‚¸ãƒ£ãƒ³ãƒ«é…è‰² */
      --genre-rain: #6B8FAD;
      --genre-fire: #C07040;
      --genre-anime: #8B6BAD;
      --genre-study: #7AAD6B;
      --genre-night: #4A5580;
      --genre-chill: #AD8B6B;
    }

    /* ======================================================
       ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ–ãƒ«ãƒ¼/ãƒ‘ãƒ¼ãƒ—ãƒ«ç³»ï¼‰
       ====================================================== */
    [data-theme="dark"] {
      /* èƒŒæ™¯è‰² */
      --bg-main: #1a1a2e;
      --bg-card: #25253d;
      --bg-header: #1a1a2e;

      /* ãƒ†ã‚­ã‚¹ãƒˆè‰² */
      --text-primary: #e8e8f0;
      --text-secondary: #9999b8;

      /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */
      --accent-blue: #7b8cde;
      --accent-blue-hover: #9aa8ed;

      /* æ¤œç´¢ãƒãƒ¼ */
      --search-bg: #25253d;
      --search-border: #3d3d5c;
      --search-border-focus: #7b8cde;

      /* ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³ */
      --genre-btn-bg: #25253d;
      --genre-btn-border: #3d3d5c;
      --genre-btn-text: #b8b8d0;
      --genre-btn-active-bg: #7b8cde;
      --genre-btn-active-text: #1a1a2e;

      /* ãƒãƒƒã‚¸è‰² */
      --badge-popular-bg: #e06b6b;
      --badge-new-bg: #6bbd6b;

      /* ã‚¸ãƒ£ãƒ³ãƒ«é…è‰²ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ç”¨ã«æ˜ã‚‹ãèª¿æ•´ï¼‰ */
      --genre-rain: #8aadd0;
      --genre-fire: #d89060;
      --genre-anime: #a88bd0;
      --genre-study: #8ec080;
      --genre-night: #7080b0;
      --genre-chill: #d0a880;
    }

    /* ======================================================
       ãƒªã‚»ãƒƒãƒˆãƒ»ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--bg-main);
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
    }

    /* ======================================================
       å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
       ====================================================== */
    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .header {
      background-color: var(--bg-header);
      padding: 16px var(--section-padding);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-inner {
      max-width: var(--content-max-width);
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
    .main-content {
      flex: 1;
      padding: var(--section-padding);
      max-width: var(--content-max-width);
      margin: 0 auto;
      width: 100%;
    }

    /* æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¨ãƒªã‚¢ */
    .search-filter-area {
      margin-bottom: var(--grid-gap);
    }

    /* ======================================================
       ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ã‚¨ãƒªã‚¢
       ====================================================== */
    .cards-area {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--grid-gap);
    }

    /* ç©ºçŠ¶æ…‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
    .empty-message {
      grid-column: 1 / -1;
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
      font-size: 15px;
    }

    /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ */
    .loading-state {
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      gap: 16px;
    }

    .loading-spinner {
      width: 36px;
      height: 36px;
      border: 3px solid var(--search-border);
      border-top-color: var(--accent-blue);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .loading-text {
      color: var(--text-secondary);
      font-size: 14px;
    }

    /* ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ */
    .error-state {
      grid-column: 1 / -1;
      text-align: center;
      padding: 60px 20px;
      color: var(--badge-popular-bg);
      font-size: 15px;
    }

    /* ======================================================
       ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    .package-card {
      background-color: var(--bg-card);
      border-radius: var(--radius-card);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
      cursor: pointer;
    }

    .package-card:hover {
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.18);
      transform: translateY(-8px) scale(1.02);
    }

    [data-theme="dark"] .package-card:hover {
      box-shadow: 0 12px 32px rgba(123, 140, 222, 0.25);
    }

    /* ã‚µãƒ ãƒã‚¤ãƒ«ã‚¨ãƒªã‚¢ */
    .card-thumbnail {
      position: relative;
      width: 100%;
      padding-top: 100%; /* 1:1 ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯” */
      overflow: hidden;
    }

    .card-thumbnail img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
    .card-thumbnail video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* YouTubeåŸ‹ã‚è¾¼ã¿ */
    .card-thumbnail iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    /* å†ç”Ÿãƒœã‚¿ãƒ³ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
    .play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.3);
      opacity: 1;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .play-icon {
      width: 60px;
      height: 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .package-card:hover .play-overlay {
      opacity: 0;
    }

    /* ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚µãƒ ãƒã‚¤ãƒ« */
    .card-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼é…è‰² */
    .card-placeholder[data-genre="rain"] {
      background: linear-gradient(135deg, #6B8FAD 0%, #8BAFC8 100%);
    }
    .card-placeholder[data-genre="fire"] {
      background: linear-gradient(135deg, #C07040 0%, #D49060 100%);
    }
    .card-placeholder[data-genre="anime"] {
      background: linear-gradient(135deg, #8B6BAD 0%, #A88BC8 100%);
    }
    .card-placeholder[data-genre="study"] {
      background: linear-gradient(135deg, #7AAD6B 0%, #98C88B 100%);
    }
    .card-placeholder[data-genre="night"] {
      background: linear-gradient(135deg, #4A5580 0%, #6A75A0 100%);
    }
    .card-placeholder[data-genre="chill"] {
      background: linear-gradient(135deg, #AD8B6B 0%, #C8A88B 100%);
    }

    /* ãƒãƒƒã‚¸ */
    .card-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 2px 10px;
      border-radius: var(--radius-badge);
      font-size: 12px;
      font-weight: 600;
      color: #FFFFFF;
      z-index: 1;
    }

    .card-badge.popular {
      background-color: var(--badge-popular-bg);
    }

    .card-badge.new {
      background-color: var(--badge-new-bg);
    }

    /* ã‚«ãƒ¼ãƒ‰æœ¬æ–‡ã‚¨ãƒªã‚¢ */
    .card-body {
      padding: 14px;
    }

    /* ã‚¿ã‚¤ãƒˆãƒ« */
    .card-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 6px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* æƒ…å ±è¡Œ */
    .card-info {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 10px;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ã‚°ã‚³ãƒ³ãƒ†ãƒŠ */
    .card-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 12px;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ã‚° */
    .card-tag {
      display: inline-block;
      padding: 2px 10px;
      border-radius: var(--radius-tag);
      font-size: 12px;
      font-weight: 500;
    }

    /* ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã‚¿ã‚°é…è‰² */
    .card-tag[data-genre="rain"] {
      background-color: rgba(107, 143, 173, 0.15);
      color: var(--genre-rain);
    }
    .card-tag[data-genre="fire"] {
      background-color: rgba(192, 112, 64, 0.15);
      color: var(--genre-fire);
    }
    .card-tag[data-genre="anime"] {
      background-color: rgba(139, 107, 173, 0.15);
      color: var(--genre-anime);
    }
    .card-tag[data-genre="study"] {
      background-color: rgba(122, 173, 107, 0.15);
      color: var(--genre-study);
    }
    .card-tag[data-genre="night"] {
      background-color: rgba(74, 85, 128, 0.15);
      color: var(--genre-night);
    }
    .card-tag[data-genre="chill"] {
      background-color: rgba(173, 139, 107, 0.15);
      color: var(--genre-chill);
    }

    /* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ */
    .card-download-btn {
      width: 100%;
      padding: 10px 16px;
      background-color: var(--accent-blue);
      border: none;
      border-radius: var(--radius-button);
      font-size: 14px;
      font-weight: 600;
      font-family: var(--font-family);
      color: #FFFFFF;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .card-download-btn:hover {
      background-color: var(--accent-blue-hover);
    }

    /* ======================================================
       ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    .logo {
      display: flex;
      align-items: baseline;
      gap: 4px;
      text-decoration: none;
      color: var(--text-primary);
    }

    .logo-main {
      font-size: 24px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }

    .logo-sub {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .lang-toggle {
      display: flex;
      gap: 4px;
      background-color: var(--bg-card);
      border-radius: var(--radius-button);
      padding: 4px;
      border: 1px solid var(--search-border);
    }

    .lang-btn {
      padding: 6px 12px;
      border: none;
      background: transparent;
      border-radius: 16px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .lang-btn:hover {
      color: var(--text-primary);
    }

    .lang-btn.active {
      background-color: var(--text-primary);
      color: var(--bg-card);
    }

    /* ãƒ†ãƒ¼ãƒãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ */
    .header-controls {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background-color: var(--bg-card);
      border: 1px solid var(--search-border);
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 18px;
    }

    .theme-toggle:hover {
      border-color: var(--accent-blue);
      transform: scale(1.05);
    }

    .theme-toggle .icon-light,
    .theme-toggle .icon-dark {
      transition: opacity 0.2s ease;
    }

    .theme-toggle .icon-dark {
      display: none;
    }

    [data-theme="dark"] .theme-toggle .icon-light {
      display: none;
    }

    [data-theme="dark"] .theme-toggle .icon-dark {
      display: inline;
    }

    /* ======================================================
       æ¤œç´¢ãƒãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    .search-container {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .search-input {
      width: 100%;
      max-width: 600px;
      padding: 14px 24px;
      font-size: 15px;
      font-family: var(--font-family);
      background-color: var(--search-bg);
      border: 1px solid var(--search-border);
      border-radius: var(--radius-search);
      color: var(--text-primary);
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .search-input::placeholder {
      color: var(--text-secondary);
    }

    .search-input:focus {
      border-color: var(--search-border-focus);
      box-shadow: 0 0 0 3px rgba(91, 155, 213, 0.15);
    }

    /* ======================================================
       ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«
       ====================================================== */
    .genre-filter {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    .genre-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      font-family: var(--font-family);
      background-color: var(--genre-btn-bg);
      border: 1px solid var(--genre-btn-border);
      border-radius: var(--radius-button);
      color: var(--genre-btn-text);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .genre-btn:hover {
      border-color: var(--text-secondary);
    }

    .genre-btn.active {
      background-color: var(--genre-btn-active-bg);
      border-color: var(--genre-btn-active-bg);
      color: var(--genre-btn-active-text);
    }

    .genre-btn .emoji {
      font-size: 16px;
    }

    /* ======================================================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–åŸºæœ¬è¨­å®š
       ====================================================== */
    @media (max-width: 1199px) {
      :root {
        --section-padding: 20px;
      }
    }

    @media (max-width: 767px) {
      :root {
        --section-padding: 16px;
        --grid-gap: 16px;
      }
    }

    @media (max-width: 479px) {
      :root {
        --section-padding: 12px;
        --grid-gap: 12px;
      }
    }

    /* ======================================================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– - æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
       ====================================================== */
    @media (max-width: 767px) {
      .logo-main {
        font-size: 20px;
      }

      .logo-sub {
        font-size: 12px;
      }

      .lang-btn {
        padding: 5px 10px;
        font-size: 12px;
      }

      .search-input {
        padding: 12px 20px;
        font-size: 14px;
      }

      .genre-filter {
        gap: 8px;
      }

      .genre-btn {
        padding: 6px 12px;
        font-size: 13px;
      }

      .genre-btn .emoji {
        font-size: 14px;
      }
    }

    @media (max-width: 479px) {
      .header {
        padding: 12px var(--section-padding);
      }

      .logo-main {
        font-size: 18px;
      }

      .logo-sub {
        font-size: 11px;
      }

      .search-container {
        margin-bottom: 16px;
      }

      .search-input {
        padding: 10px 16px;
        font-size: 14px;
        border-radius: 20px;
      }

      .genre-filter {
        gap: 6px;
      }

      .genre-btn {
        padding: 6px 10px;
        font-size: 12px;
        border-radius: 16px;
      }

      .genre-btn .emoji {
        font-size: 13px;
      }
    }

    /* ======================================================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– - ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰
       ====================================================== */
    /* 1200pxä»¥ä¸Š: 4åˆ—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ */

    /* 768pxã€œ1199px: 3åˆ— */
    @media (max-width: 1199px) {
      .cards-area {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    /* 480pxã€œ767px: 2åˆ— */
    @media (max-width: 767px) {
      .cards-area {
        grid-template-columns: repeat(2, 1fr);
      }

      .card-body {
        padding: 12px;
      }

      .card-title {
        font-size: 14px;
      }

      .card-info {
        font-size: 12px;
      }

      .card-tags {
        gap: 4px;
        margin-bottom: 10px;
      }

      .card-tag {
        font-size: 11px;
        padding: 2px 8px;
      }

      .card-download-btn {
        padding: 8px 12px;
        font-size: 13px;
      }

      .card-placeholder {
        font-size: 36px;
      }
    }

    /* 479pxä»¥ä¸‹: 1åˆ— */
    @media (max-width: 479px) {
      .cards-area {
        grid-template-columns: 1fr;
      }

      .card-placeholder {
        font-size: 48px;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
      <div class="header-inner">
        <!-- ãƒ­ã‚´ -->
        <a href="#" class="logo">
          <span class="logo-main">Lo-Fi</span>
          <span class="logo-sub">Video Templates</span>
        </a>

        <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ -->
        <div class="header-controls">
          <!-- ãƒ†ãƒ¼ãƒãƒˆã‚°ãƒ« -->
          <button type="button" class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
            <span class="icon-light">â˜€ï¸</span>
            <span class="icon-dark">ğŸŒ™</span>
          </button>

          <!-- è¨€èªãƒˆã‚°ãƒ« -->
          <div class="lang-toggle">
            <button type="button" class="lang-btn active" data-lang="ja">JA</button>
            <button type="button" class="lang-btn" data-lang="en">EN</button>
          </div>
        </div>
      </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content">
      <!-- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¨ãƒªã‚¢ -->
      <section class="search-filter-area">
        <!-- æ¤œç´¢ãƒãƒ¼ -->
        <div class="search-container">
          <input
            type="text"
            class="search-input"
            id="search-input"
            placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢"
            data-i18n-placeholder="searchPlaceholder"
          >
        </div>

        <!-- ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="genre-filter" id="genre-filter">
          <button type="button" class="genre-btn" data-genre="rain">
            <span class="emoji">ğŸŒ§ï¸</span>
            <span data-i18n="genres.rain">é›¨</span>
          </button>
          <button type="button" class="genre-btn" data-genre="fire">
            <span class="emoji">ğŸ”¥</span>
            <span data-i18n="genres.fire">ç«</span>
          </button>
          <button type="button" class="genre-btn" data-genre="anime">
            <span class="emoji">ğŸ¬</span>
            <span data-i18n="genres.anime">ã‚¢ãƒ‹ãƒ¡</span>
          </button>
          <button type="button" class="genre-btn" data-genre="study">
            <span class="emoji">ğŸ“š</span>
            <span data-i18n="genres.study">å‹‰å¼·</span>
          </button>
          <button type="button" class="genre-btn" data-genre="night">
            <span class="emoji">ğŸŒ™</span>
            <span data-i18n="genres.night">å¤œ</span>
          </button>
          <button type="button" class="genre-btn" data-genre="chill">
            <span class="emoji">â˜•</span>
            <span data-i18n="genres.chill">ãƒãƒ«</span>
          </button>
        </div>
      </section>

      <!-- ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ã‚¨ãƒªã‚¢ -->
      <section class="cards-area" id="cards-container">
        <!-- JavaScriptã§å‹•çš„ã«æç”» -->
      </section>
    </main>
  </div>

  <!-- JavaScript -->
  <script type="module">
    // ======================================================
    // Firebase SDK ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆCDNï¼‰
    // ======================================================
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy }
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";
    import { getStorage, ref, getDownloadURL }
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-storage.js";

    // ======================================================
    // Firebase è¨­å®šï¼ˆã“ã“ã‚’æ›¸ãæ›ãˆã‚‹ã ã‘ã§æ¥ç¶šå…ˆå¤‰æ›´ï¼‰
    // ======================================================
    const FIREBASE_CONFIG = {
      apiKey: "",            // â† è‡ªåˆ†ã®ã‚­ãƒ¼ã‚’å…¥åŠ›
      authDomain: "",        // â† è‡ªåˆ†ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å…¥åŠ›
      projectId: "",         // â† è‡ªåˆ†ã®IDã‚’å…¥åŠ›
      storageBucket: "",     // â† è‡ªåˆ†ã®ãƒã‚±ãƒƒãƒˆã‚’å…¥åŠ›
      messagingSenderId: "", // â† è‡ªåˆ†ã®IDã‚’å…¥åŠ›
      appId: ""              // â† è‡ªåˆ†ã®IDã‚’å…¥åŠ›
    };
    // ä¸Šè¨˜ãŒç©º or ç„¡åŠ¹ â†’ è‡ªå‹•ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚‹
    // ======================================================

    // Firebase ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆè¨­å®šæœ‰åŠ¹æ™‚ã®ã¿åˆæœŸåŒ–ï¼‰
    let db = null;
    let storage = null;

    // ======================================================
    // ã‚¸ãƒ£ãƒ³ãƒ«å®šç¾©ï¼ˆçµµæ–‡å­—ãƒãƒƒãƒ”ãƒ³ã‚°ï¼‰
    // ======================================================
    const GENRE_EMOJI = {
      rain: 'ğŸŒ§ï¸',
      fire: 'ğŸ”¥',
      anime: 'ğŸ¬',
      study: 'ğŸ“š',
      night: 'ğŸŒ™',
      chill: 'â˜•'
    };

    // ======================================================
    // i18n è¾æ›¸
    // ======================================================
    const I18N = {
      ja: {
        searchPlaceholder: 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢',
        genres: {
          rain: 'é›¨',
          fire: 'ç«',
          anime: 'ã‚¢ãƒ‹ãƒ¡',
          study: 'å‹‰å¼·',
          night: 'å¤œ',
          chill: 'ãƒãƒ«'
        },
        badge: {
          popular: 'äººæ°—',
          new: 'æ–°ä½œ'
        },
        downloadBtn: 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
        emptyMessage: 'è©²å½“ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã›ã‚“',
        loading: 'èª­ã¿è¾¼ã¿ä¸­...',
        error: 'ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ',
        duration: 'åˆ†',
        comingSoon: 'æº–å‚™ä¸­ã§ã™ã€‚ã‚‚ã†ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚'
      },
      en: {
        searchPlaceholder: 'Search by keyword',
        genres: {
          rain: 'Rain',
          fire: 'Fire',
          anime: 'Anime',
          study: 'Study',
          night: 'Night',
          chill: 'Chill'
        },
        badge: {
          popular: 'Popular',
          new: 'New'
        },
        downloadBtn: 'Download',
        emptyMessage: 'No packages found',
        loading: 'Loading...',
        error: 'Failed to load data',
        duration: 'min',
        comingSoon: 'Coming soon. Please wait.'
      }
    };

    // ======================================================
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆFirebaseæ¥ç¶šå¤±æ•—æ™‚ã«ä½¿ç”¨ï¼‰
    // ======================================================
    const LOCAL_PACKAGES = [
      {
        id: 'rain-lofi-work',
        title_ja: 'é›¨éŸ³Ã—Lo-Fi ä½œæ¥­ç”¨',
        title_en: 'Rain Ã— Lo-Fi Work',
        genres: ['rain', 'study'],
        durationMinutes: 60,
        size: '1.2GB',
        badge: 'popular',
        thumbnailPath: '',
        previewPath: '',  // previews/rain-lofi-work.mp4
        downloadPath: '',
        order: 1
      },
      {
        id: 'fire-lofi-healing',
        title_ja: 'ç„šãç«Ã—Lo-Fi ç™’ã—ç³»',
        title_en: 'Bonfire Ã— Lo-Fi Healing',
        genres: ['fire', 'chill'],
        durationMinutes: 60,
        size: '1.27GB',
        badge: 'new',
        thumbnailPath: '',
        previewPath: '',
        previewUrl: '',
        // YouTubeå‹•ç”»IDï¼ˆè¦–è´ç”¨ï¼‰
        youtubeId: 'TKbyXrcEpuQ',
        downloadPath: '',
        // Google Driveç›´æ¥ãƒªãƒ³ã‚¯ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ï¼‰
        downloadUrl: '',
        order: 2
      },
      {
        id: 'night-city-lofi',
        title_ja: 'å¤œã®è¡—Ã—Lo-Fi æ•£æ­©ç”¨',
        title_en: 'Night City Ã— Lo-Fi Walk',
        genres: ['night', 'anime'],
        durationMinutes: 60,
        size: '1.5GB',
        badge: 'popular',
        thumbnailPath: '',
        previewPath: '',  // previews/night-city-lofi.mp4
        downloadPath: '',
        order: 3
      },
      {
        id: 'cafe-lofi-reading',
        title_ja: 'ã‚«ãƒ•ã‚§Ã—Lo-Fi èª­æ›¸ç”¨',
        title_en: 'CafÃ© Ã— Lo-Fi Reading',
        genres: ['rain', 'study'],
        durationMinutes: 60,
        size: '1.1GB',
        badge: 'new',
        thumbnailPath: '',
        previewPath: '',  // previews/cafe-lofi-reading.mp4
        downloadPath: '',
        order: 4
      },
      {
        id: 'sakura-lofi-spring',
        title_ja: 'æ¡œÃ—Lo-Fi æ˜¥ã®ä½œæ¥­ç”¨',
        title_en: 'Sakura Ã— Lo-Fi Spring',
        genres: ['chill', 'study'],
        durationMinutes: 60,
        size: '1.3GB',
        badge: 'popular',
        thumbnailPath: '',
        previewPath: '',  // previews/sakura-lofi-spring.mp4
        downloadPath: '',
        order: 5
      },
      {
        id: 'forest-lofi-nature',
        title_ja: 'æ£®æ—Ã—Lo-Fi è‡ªç„¶éŸ³',
        title_en: 'Forest Ã— Lo-Fi Nature',
        genres: ['rain', 'chill'],
        durationMinutes: 60,
        size: '1.0GB',
        badge: 'new',
        thumbnailPath: '',
        previewPath: '',  // previews/forest-lofi-nature.mp4
        downloadPath: '',
        order: 6
      },
      {
        id: 'ocean-lofi-waves',
        title_ja: 'æµ·Ã—Lo-Fi æ³¢ã®éŸ³',
        title_en: 'Ocean Ã— Lo-Fi Waves',
        genres: ['chill', 'night'],
        durationMinutes: 60,
        size: '1.4GB',
        badge: 'popular',
        thumbnailPath: '',
        previewPath: '',  // previews/ocean-lofi-waves.mp4
        downloadPath: '',
        order: 7
      },
      {
        id: 'bedroom-lofi-sleep',
        title_ja: 'ãƒ™ãƒƒãƒ‰ãƒ«ãƒ¼ãƒ Ã—Lo-Fi ç¡çœ ç”¨',
        title_en: 'Bedroom Ã— Lo-Fi Sleep',
        genres: ['night', 'chill'],
        durationMinutes: 60,
        size: '1.1GB',
        badge: 'new',
        thumbnailPath: '',
        previewPath: '',  // previews/bedroom-lofi-sleep.mp4
        downloadPath: '',
        order: 8
      }
    ];

    // ======================================================
    // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
    // ======================================================
    const state = {
      packages: [],
      filteredPackages: [],
      selectedGenres: [],
      searchQuery: '',
      currentLang: 'ja',
      currentTheme: 'light',
      isLoading: false
    };

    // ======================================================
    // Firebase è¨­å®šãƒã‚§ãƒƒã‚¯
    // ======================================================
    function isFirebaseConfigured() {
      return FIREBASE_CONFIG.apiKey && FIREBASE_CONFIG.projectId;
    }

    // ======================================================
    // Firebase åˆæœŸåŒ–
    // ======================================================
    function initializeFirebase() {
      if (!isFirebaseConfigured()) return false;
      try {
        const app = initializeApp(FIREBASE_CONFIG);
        db = getFirestore(app);
        storage = getStorage(app);
        return true;
      } catch (e) {
        console.warn('FirebaseåˆæœŸåŒ–å¤±æ•—:', e);
        return false;
      }
    }

    // ======================================================
    // ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆFirebaseå„ªå…ˆ â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
    // ======================================================
    async function loadPackages() {
      // 1. Firebaseæ¥ç¶šã‚’è©¦è¡Œ
      if (isFirebaseConfigured() && db) {
        try {
          const snapshot = await getDocs(
            query(collection(db, 'packages'), orderBy('order'))
          );
          if (!snapshot.empty) {
            const packages = snapshot.docs
              .map(doc => doc.data())
              .filter(pkg => pkg.visible !== false);
            return packages;
          }
        } catch (e) {
          console.warn('Firestoreå–å¾—å¤±æ•—ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¸:', e);
        }
      }

      // 2. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™
      return LOCAL_PACKAGES;
    }

    // ======================================================
    // ã‚µãƒ ãƒã‚¤ãƒ«URLè§£æ±ºï¼ˆStorageå„ªå…ˆ â†’ nullï¼‰
    // ======================================================
    async function resolveThumbnail(pkg) {
      if (pkg.thumbnailPath && isFirebaseConfigured() && storage) {
        try {
          return await getDownloadURL(ref(storage, pkg.thumbnailPath));
        } catch (e) {
          // ãƒ•ã‚¡ã‚¤ãƒ«æœªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ nullã«è½ã¡ã‚‹
        }
      }
      return null; // â†’ CSSãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼è¡¨ç¤º
    }

    // ======================================================
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ç”»URLè§£æ±ºï¼ˆç›´æ¥URLå„ªå…ˆ â†’ Storage â†’ nullï¼‰
    // ======================================================
    async function resolvePreview(pkg) {
      // 1. Google Driveç­‰ã®ç›´æ¥URLãŒã‚ã‚Œã°ãã‚Œã‚’ä½¿ç”¨
      if (pkg.previewUrl) {
        return pkg.previewUrl;
      }
      // 2. Firebase Storage ãƒ‘ã‚¹ãŒã‚ã‚Œã°è§£æ±º
      if (pkg.previewPath && isFirebaseConfigured() && storage) {
        try {
          return await getDownloadURL(ref(storage, pkg.previewPath));
        } catch (e) {
          // ãƒ•ã‚¡ã‚¤ãƒ«æœªã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ nullã«è½ã¡ã‚‹
        }
      }
      return null;
    }

    // ======================================================
    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
    // ======================================================
    async function handleDownload(pkgId) {
      const pkg = state.packages.find(p => p.id === pkgId);
      if (!pkg) return;

      // 1. Google Driveç­‰ã®ç›´æ¥URLãŒã‚ã‚Œã°ãã‚Œã‚’ä½¿ç”¨
      if (pkg.downloadUrl) {
        const a = document.createElement('a');
        a.href = pkg.downloadUrl;
        a.download = '';
        a.target = '_blank'; // Google Driveã¯æ–°è¦ã‚¿ãƒ–ã§é–‹ã
        a.click();
        return;
      }

      // 2. Firebase Storage ãƒ‘ã‚¹ãŒã‚ã‚Œã°è§£æ±º
      if (pkg.downloadPath && isFirebaseConfigured() && storage) {
        try {
          const url = await getDownloadURL(ref(storage, pkg.downloadPath));
          const a = document.createElement('a');
          a.href = url;
          a.download = '';
          a.click();
          return;
        } catch (e) {
          console.warn('DLãƒ•ã‚¡ã‚¤ãƒ«æœªè¨­å®š:', pkg.id);
        }
      }

      // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: æº–å‚™ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
      alert(t('comingSoon'));
    }

    // ======================================================
    // DOMè¦ç´ 
    // ======================================================
    const cardsContainer = document.getElementById('cards-container');
    const searchInput = document.getElementById('search-input');
    const genreFilter = document.getElementById('genre-filter');
    const genreButtons = genreFilter.querySelectorAll('.genre-btn');
    const langButtons = document.querySelectorAll('.lang-btn');
    const themeToggle = document.getElementById('theme-toggle');

    // ======================================================
    // i18n ãƒ†ã‚­ã‚¹ãƒˆå–å¾—ãƒ˜ãƒ«ãƒ‘ãƒ¼
    // ======================================================
    function t(key) {
      const keys = key.split('.');
      let value = I18N[state.currentLang];
      for (const k of keys) {
        value = value?.[k];
      }
      return value || key;
    }

    // ======================================================
    // è¨€èªåˆ‡æ›¿
    // ======================================================
    function setLanguage(lang) {
      if (lang === state.currentLang) return;
      state.currentLang = lang;

      // html langå±æ€§ã‚’æ›´æ–°
      document.documentElement.lang = lang;

      // è¨€èªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
      langButtons.forEach(btn => {
        if (btn.dataset.lang === lang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      // UIãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
      applyLanguageToUI();

      // ã‚«ãƒ¼ãƒ‰ã‚’å†æç”»ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ç­‰ãŒè¨€èªã«å¿œã˜ã¦å¤‰ã‚ã‚‹ï¼‰
      renderCards(state.filteredPackages);
    }

    // ======================================================
    // ãƒ†ãƒ¼ãƒåˆ‡æ›¿
    // ======================================================
    function setTheme(theme) {
      if (theme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
      } else {
        document.documentElement.removeAttribute('data-theme');
      }
      // localStorageã«ä¿å­˜
      localStorage.setItem('theme', theme);
      state.currentTheme = theme;
    }

    function toggleTheme() {
      const newTheme = state.currentTheme === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
    }

    function loadSavedTheme() {
      // 1. localStorageã‹ã‚‰å–å¾—
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        setTheme(savedTheme);
        return;
      }
      // 2. ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã‚’ç¢ºèª
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        setTheme('dark');
        return;
      }
      // 3. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰
      setTheme('light');
    }

    // ======================================================
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    // ======================================================
    function showLoading() {
      cardsContainer.innerHTML = `
        <div class="loading-state">
          <div class="loading-spinner"></div>
          <div class="loading-text">${t('loading')}</div>
        </div>
      `;
    }

    // ======================================================
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤ºï¼ˆrenderCardsã§ä¸Šæ›¸ãã•ã‚Œã‚‹ã®ã§æ˜ç¤ºçš„ãªå‡¦ç†ä¸è¦ï¼‰
    // ======================================================
    function hideLoading() {
      // renderCards() ãŒå‘¼ã°ã‚Œã‚‹ã¨è‡ªå‹•çš„ã«ã‚¯ãƒªã‚¢ã•ã‚Œã‚‹
    }

    // ======================================================
    // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
    // ======================================================
    function showError() {
      cardsContainer.innerHTML = `
        <div class="error-state">${t('error')}</div>
      `;
    }

    // ======================================================
    // UIãƒ†ã‚­ã‚¹ãƒˆã«è¨€èªã‚’é©ç”¨
    // ======================================================
    function applyLanguageToUI() {
      // æ¤œç´¢ãƒãƒ¼ã®placeholder
      searchInput.placeholder = t('searchPlaceholder');

      // ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«
      genreButtons.forEach(btn => {
        const genre = btn.dataset.genre;
        const labelSpan = btn.querySelector('[data-i18n]');
        if (labelSpan) {
          labelSpan.textContent = t(`genres.${genre}`);
        }
      });
    }

    // ======================================================
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ»æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯
    // ======================================================
    function applyFilters() {
      let filtered = [...state.packages];

      // ã‚¸ãƒ£ãƒ³ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆANDæ¤œç´¢: é¸æŠä¸­ã®ã‚¸ãƒ£ãƒ³ãƒ«ã™ã¹ã¦ã‚’å«ã‚€ï¼‰
      if (state.selectedGenres.length > 0) {
        filtered = filtered.filter(pkg =>
          state.selectedGenres.every(genre => pkg.genres.includes(genre))
        );
      }

      // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ï¼ˆã‚¿ã‚¤ãƒˆãƒ«JA/ENã‚’å¯¾è±¡ã€å¤§æ–‡å­—å°æ–‡å­—åŒºåˆ¥ãªã—ï¼‰
      if (state.searchQuery.trim() !== '') {
        const query = state.searchQuery.toLowerCase().trim();
        filtered = filtered.filter(pkg => {
          const titleJa = pkg.title_ja.toLowerCase();
          const titleEn = pkg.title_en.toLowerCase();
          return titleJa.includes(query) || titleEn.includes(query);
        });
      }

      state.filteredPackages = filtered;
      renderCards(state.filteredPackages);
    }

    // ======================================================
    // ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³åˆ‡æ›¿
    // ======================================================
    function toggleGenre(genre) {
      const index = state.selectedGenres.indexOf(genre);
      if (index === -1) {
        // æœªé¸æŠ â†’ é¸æŠã«è¿½åŠ 
        state.selectedGenres.push(genre);
      } else {
        // é¸æŠæ¸ˆã¿ â†’ é¸æŠè§£é™¤
        state.selectedGenres.splice(index, 1);
      }
      updateGenreButtonStates();
      applyFilters();
    }

    // ======================================================
    // ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³çŠ¶æ…‹æ›´æ–°
    // ======================================================
    function updateGenreButtonStates() {
      genreButtons.forEach(btn => {
        const genre = btn.dataset.genre;
        if (state.selectedGenres.includes(genre)) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
    }

    // ======================================================
    // æ¤œç´¢å…¥åŠ›ãƒãƒ³ãƒ‰ãƒ©ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
    // ======================================================
    function handleSearchInput(e) {
      state.searchQuery = e.target.value;
      applyFilters();
    }

    // ======================================================
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
    // ======================================================
    function setupEventListeners() {
      // æ¤œç´¢å…¥åŠ›ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
      searchInput.addEventListener('input', handleSearchInput);

      // ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³
      genreButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const genre = btn.dataset.genre;
          toggleGenre(genre);
        });
      });

      // è¨€èªåˆ‡æ›¿ãƒœã‚¿ãƒ³
      langButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const lang = btn.dataset.lang;
          setLanguage(lang);
        });
      });

      // ãƒ†ãƒ¼ãƒåˆ‡æ›¿ãƒœã‚¿ãƒ³
      themeToggle.addEventListener('click', toggleTheme);
    }

    // ======================================================
    // ã‚«ãƒ¼ãƒ‰æç”»é–¢æ•°
    // ======================================================
    function renderCards(packages) {
      // ã‚³ãƒ³ãƒ†ãƒŠã‚’ã‚¯ãƒªã‚¢
      cardsContainer.innerHTML = '';

      // ç©ºçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
      if (packages.length === 0) {
        const emptyMsg = document.createElement('div');
        emptyMsg.className = 'empty-message';
        emptyMsg.textContent = t('emptyMessage');
        cardsContainer.appendChild(emptyMsg);
        return;
      }

      // å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
      packages.forEach(pkg => {
        const card = createCardElement(pkg);
        cardsContainer.appendChild(card);
      });
    }

    // ======================================================
    // ã‚«ãƒ¼ãƒ‰è¦ç´ ç”Ÿæˆé–¢æ•°
    // ======================================================
    function createCardElement(pkg) {
      const card = document.createElement('article');
      card.className = 'package-card';
      card.dataset.id = pkg.id;

      // ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆè¨€èªã«å¿œã˜ã¦åˆ‡æ›¿ï¼‰
      const title = state.currentLang === 'ja' ? pkg.title_ja : pkg.title_en;

      // ä¸»è¦ã‚¸ãƒ£ãƒ³ãƒ«ï¼ˆãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç”¨ï¼‰
      const primaryGenre = pkg.genres[0] || 'chill';

      // ãƒãƒƒã‚¸HTML
      let badgeHtml = '';
      if (pkg.badge === 'popular') {
        badgeHtml = `<span class="card-badge popular">${t('badge.popular')}</span>`;
      } else if (pkg.badge === 'new') {
        badgeHtml = `<span class="card-badge new">${t('badge.new')}</span>`;
      }

      // ã‚µãƒ ãƒã‚¤ãƒ«/å‹•ç”»HTMLï¼ˆå„ªå…ˆé †ä½: YouTube > å‹•ç”» > ç”»åƒ > ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼‰
      let thumbnailHtml;
      let hasVideo = false;
      let hasYoutube = false;

      if (pkg.youtubeId) {
        // YouTubeåŸ‹ã‚è¾¼ã¿ãŒã‚ã‚‹å ´åˆ
        hasYoutube = true;
        thumbnailHtml = `
          <iframe
            src="https://www.youtube.com/embed/${pkg.youtubeId}?rel=0&modestbranding=1"
            title="${title}"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
          </iframe>
        `;
      } else if (pkg.resolvedPreviewUrl) {
        // å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã‚ã‚‹å ´åˆ
        hasVideo = true;
        thumbnailHtml = `
          <video muted loop playsinline preload="metadata">
            <source src="${pkg.resolvedPreviewUrl}" type="video/mp4">
          </video>
          <div class="play-overlay">
            <div class="play-icon">â–¶</div>
          </div>
        `;
      } else if (pkg.resolvedThumbnailUrl) {
        // é™æ­¢ç”»ã‚µãƒ ãƒã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆ
        thumbnailHtml = `<img src="${pkg.resolvedThumbnailUrl}" alt="${title}" loading="lazy">`;
      } else {
        // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
        const emoji = GENRE_EMOJI[primaryGenre] || 'ğŸµ';
        thumbnailHtml = `<div class="card-placeholder" data-genre="${primaryGenre}">${emoji}</div>`;
      }

      // ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ã‚°HTML
      const tagsHtml = pkg.genres.map(genre => {
        const genreLabel = t(`genres.${genre}`);
        return `<span class="card-tag" data-genre="${genre}">${genreLabel}</span>`;
      }).join('');

      // å†ç”Ÿæ™‚é–“ã¨å®¹é‡
      const duration = pkg.durationMinutes || 60;
      const fileSize = pkg.size || '1.0GB';

      // ã‚«ãƒ¼ãƒ‰HTMLçµ„ã¿ç«‹ã¦
      card.innerHTML = `
        <div class="card-thumbnail">
          ${badgeHtml}
          ${thumbnailHtml}
        </div>
        <div class="card-body">
          <h3 class="card-title">${title}</h3>
          <div class="card-info">â± ${duration}${t('duration')} ğŸ’¾ ${fileSize}</div>
          <div class="card-tags">${tagsHtml}</div>
          <button type="button" class="card-download-btn" data-id="${pkg.id}">
            ${t('downloadBtn')}
          </button>
        </div>
      `;

      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
      const downloadBtn = card.querySelector('.card-download-btn');
      downloadBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        handleDownload(pkg.id);
      });

      // å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ›ãƒãƒ¼å†ç”Ÿ + ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
      if (hasVideo) {
        const video = card.querySelector('video');
        const thumbnail = card.querySelector('.card-thumbnail');

        // å‹•ç”»èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã«åˆ‡ã‚Šæ›¿ãˆ
        video.addEventListener('error', () => {
          const emoji = GENRE_EMOJI[primaryGenre] || 'ğŸµ';
          thumbnail.innerHTML = `
            ${badgeHtml}
            <div class="card-placeholder" data-genre="${primaryGenre}">${emoji}</div>
          `;
        });

        card.addEventListener('mouseenter', () => {
          video.play().catch(() => {});
        });
        card.addEventListener('mouseleave', () => {
          video.pause();
          video.currentTime = 0;
        });
      }

      return card;
    }

    // ======================================================
    // ã‚µãƒ ãƒã‚¤ãƒ«ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLä¸€æ‹¬è§£æ±º
    // ======================================================
    async function resolveAllThumbnails(packages) {
      const resolved = await Promise.all(
        packages.map(async (pkg) => {
          const [thumbnailUrl, previewUrl] = await Promise.all([
            resolveThumbnail(pkg),
            resolvePreview(pkg)
          ]);
          return {
            ...pkg,
            resolvedThumbnailUrl: thumbnailUrl,
            resolvedPreviewUrl: previewUrl
          };
        })
      );
      return resolved;
    }

    // ======================================================
    // åˆæœŸåŒ–
    // ======================================================
    async function init() {
      // ä¿å­˜ã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’èª­ã¿è¾¼ã¿
      loadSavedTheme();

      // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
      setupEventListeners();

      // FirebaseåˆæœŸåŒ–
      initializeFirebase();

      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
      state.isLoading = true;
      showLoading();

      try {
        // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        const packages = await loadPackages();
        // ã‚µãƒ ãƒã‚¤ãƒ«URLè§£æ±º
        state.packages = await resolveAllThumbnails(packages);
        state.filteredPackages = [...state.packages];
        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµ‚äº† â†’ ã‚«ãƒ¼ãƒ‰æç”»
        state.isLoading = false;
        renderCards(state.filteredPackages);
      } catch (e) {
        console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        state.isLoading = false;

        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚‚å¤±æ•—ã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        // é€šå¸¸ã¯loadPackages()ãŒLOCAL_PACKAGESã‚’è¿”ã™ã®ã§åˆ°é”ã—ãªã„
        if (state.packages.length === 0) {
          // æœ€å¾Œã®æ‰‹æ®µã¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥ä½¿ç”¨
          state.packages = LOCAL_PACKAGES;
          state.filteredPackages = [...state.packages];
          renderCards(state.filteredPackages);
        } else {
          showError();
        }
      }
    }

    // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
